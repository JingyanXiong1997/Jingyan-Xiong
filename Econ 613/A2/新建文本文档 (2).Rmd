## Exercise 2 First Model
```{r}
x=nrow(choicePrice)
y=ncol(choicePrice[,3:12])
Y=matrix(0,x,y)
for(i in 1:y){
  for(j in 2:x){
    if(choicePrice$choice[j]==i){
      Y[j,i]=1
    }
  }
}
Y[1,1]=1

clogit=function(beta){
 intercept=matrix(rep(beta[1:y-1],each=x),nrow=x,ncol=y-1)
 XB=choicePrice[,3:12]*beta[y]
 XB=cbind(0,intercept)+XB
 eXB=exp(XB)
 teXB=rowSums(eXB)
 prob=eXB/teXB
 like=sum(Y*log(prob))
 return(-like)
}
set.seed(100)
param1=runif(10,-1,1)
model1=optim(param1,clogit,method="BFGS")
model1$par
```